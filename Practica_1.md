| Paso                                 | **Emisor**                                                                                                                | **Receptor**                                                                                                                     |
|:-------------------------------------|---------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|
| **1.** Generación de claves privadas | `openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:2048 -pkeyopt rsa_keygen_pubexp:3 -out clave_privada_emisor.pem` | `openssl genpkey -algorithm RSA -pkeyopt rsa_keygen_bits:2048 -pkeyopt rsa_keygen_pubexp:5 -out clave_privada_receptor.pem`      |
| **2.** Generación de claves públicas | `openssl pkey -in clave_privada_emisor.pem -out clave_publica_emisor.pem -pubout`                                         | `openssl pkey -in clave_privada_receptor.pem -out clave_publica_receptor.pem -pubout`                                            |
| **3.** Intercambio de claves         | Emisor le manda por Telegram a Receptor su clave pública                                                                  | Receptor le manda por Telegram a Emisor su clave pública                                                                         |
| **4.** Generar un mensaje            | `echo "Capitan ponganos una buena nota" > mensaje_suplica.txt`                                                        | .                                                                                                                                |
| **5.** Firmar el mensaje             | `openssl dgst -sha256 -sign clave_privada_emisor.pem -out mensaje_firmado_emisor.txt.sgn mensaje_suplica.txt`             | .                                                                                                                                |
| **6.** Cifrar el mensaje             | `openssl rsautl -encrypt -inkey clave_publica_receptor.pem -pubin -in mensaje_suplica.txt -out mensaje_suplica.txt.enc`   | .                                                                                                                                |
| **7.** Envío de mensaje y de firma   | Emisor le manda por Telegram al receptor los ficheros `mensaje_suplica.txt.enc` y `mensaje_suplica.txt.sgn`               | .                                                                                                                                |
| **8.** Descifrado de mensaje         | .                                                                                                                         | `openssl pkeyutl -decrypt -in mensaje_suplica.txt.enc -inkey clave_privada_receptor.pem -out mensaje_suplica_descifrada.txt`     |
| **9.** Verificación de emisor        | .                                                                                                                         | `openssl dgst -sha256 -verify clave_publica_emisor.pem -signature mensaje_firmado_emisor.txt.sgn mensaje_suplica_descifrada.txt` |
| **10.** Los usuarios están contentos | :tada:                                                                                                                    | :tada:                                                                                                                           |
