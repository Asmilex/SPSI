| Paso                                                            | **Bob (emisor)**                                                                               | **Alice (receptor)**                                                                                         |
|:----------------------------------------------------------------|------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|
| **1. Bob pasa su PDF a base64.**                                | `openssl base64 -in gdh.pdf -out gdh.b64`                                                      | .                                                                                                            |
| **1. Bob firma con su certificado el archivo anterior.**        | `openssl smime -sign -in gdh.b64 -out gdh_firmado.b64 -signer bob.cert.pem -inkey bob.key.pem` | .                                                                                                            |
| **2. Bob cifra el texto firmado.**                              | `openssl smime -encrypt -in gdh_firmado.b64 -out gdh_cifrado.b64 alice.cert.pem`               | .                                                                                                            |
| **3. Bob envía el archivo cifrado. Por ejemplo, por Telegram.** | :email:                                                                                        | .                                                                                                            |
| **4. Alice desgarga el PDF cifrado.**                           | .                                                                                              | :mailbox_with_mail:                                                                                          |
| **5. Alice descifra el archivo.**                               | .                                                                                              | `openssl smime -decrypt -in gdh_cifrado.b64 -out gdh_firmado.b64 -recip alice.cert.pem -inkey alice.key.pem` |
| **6. Alice comprueba que la firma de Bob.**                     | .                                                                                              | `openssl smime -pk7out -in gdh_firmado.b64 | openssl pkcs7 -print_certs -noout`                              |
| **7. Alice verifica el mensaje firmado.**                       | .                                                                                              | `openssl smime -verify -in gdh_firmado.b64 -noverify -out gdh.b64`                                           |
| **8. Alice decodifica el archivo en base64 a PDF.**             | .                                                                                              | `openssl base64 -d -in gdh.b64 -out gdh.pdf`                                                                 |
| **9. Alice visualiza el PDF.**                                  | .                                                                                              | :page_with_curl:                                                                                             |
| **10. Bob y Alice están contentos**                             | :tada:                                                                                         | :tada:                                                                                                       |